<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <title>ステータス変更</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 2rem;
            background: #f0f0f0;
        }

        form {
            display: flex;
            flex-direction: column;
            max-width: 300px;
        }

        input,
        button {
            padding: 0.5rem;
            margin-top: 0.5rem;
        }

        #result {
            margin-top: 1rem;
            color: green;
        }
    </style>
</head>

<body>
    <h1>ステータスを変更</h1>
    <form id="statusForm">
        <label for="newStatus">新しいステータス：</label>
        <input type="text" id="newStatus" placeholder="例: 勉強中" required />
        <button type="submit">送信</button>
    </form>
    <p id="result"></p>

    <script>
        const BIN_ID = '682a9d198a456b7966a0ca55';
        const MASTER_KEY = '$2a$10$bEqn/AHi/5SY22I7fDM90OQeWK33Zl2YiJP4f.tOSmG3rVvoCrwSu';

        document.getElementById('statusForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const newStatus = document.getElementById('newStatus').value;

            const now = new Date().toISOString();

            try {
                const response = await fetch(`https://api.jsonbin.io/v3/b/ ${BIN_ID}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': MASTER_KEY
                    },
                    body: JSON.stringify({
                        status: newStatus,
                        updated_at: now
                    })
                });

                if (response.ok) {
                    document.getElementById('result').textContent = '✅ ステータスを更新しました！';
                } else {
                    const errorText = await response.text();
                    document.getElementById('result').textContent = '❌ エラー: ' + errorText;
                }

            } catch (err) {
                console.error(err);
                document.getElementById('result').textContent = '⚠️ ネットワークエラーが発生しました';
            }
        });
    </script>
</body>

</html>